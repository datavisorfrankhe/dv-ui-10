# 维择科技规则引擎

## 规则引擎简介

### 定义

“**规则**”是**规则引擎**的基本组成部分。
- 规则由 "IF（**条件**)” 和 “THEN（**动作**)” 逻辑组成：如果满足条件，则执行动作。

在 "IF（条件)” 中，可以有 "AND/OR/NOT" 逻辑连接在一起。

**例如：**
- 条件 1："User_name" 包含 “John”
- 条件2："Checkout_time" < 5秒
- 辑连: "User_name" 包含 “John” AND "Checkout_time" < 5秒

目前，维择科技支持创建两种类型规则：“**手动规则**”和“**自动规则**”。“手动规则”，顾名思义，是由分析人员通过“创建规则”页面创建的。“自动规则”，由维择科技的机器学习模型生成，并根据实际数据集在规则引擎中实时更新，但这是一项附加功能，需要额外购买。

当某个事件或用户被规则检测到时，维择科技会以预先设定好的格式将响应动作发送到下游系统后端。 并且在响应数据中，会包含您在创建规则时指定的操作方式和操作数据。

“**规则集**”是一组规则，也可以将“手动规则”和“自动规则”组合在一起。 下图说明如何将规则引擎的各元素联系在一起：

> 图 1: 规则集
![image-1]

### 工作流程

> 图  2: 规则逻辑结构和工作流程
![image-2]

在规则引擎里你可以进行常规操作，包括 “**创建规则**”，“**测试规则**”和“**管理规则**”。

**创建规则：**
- **添加条件（“IF” 逻辑）：** 实体（用户或事件）经过规则引擎时，将根据规则中设置的条件检查该实体。 如果满足这些条件，则将触发“THEN”逻辑中的动作。
  - **例如：** IF ("Transaction amount" > 5000 AND "Checkout speed" < 10)
- **指定动作（“THEN” 逻辑）：** 满足“IF”中的条件后，将触发所有选择的动作。
  - **例如：** THEN 冻结交易，并发送“高频交易”
- **其他详细信息：** 例如为该规则添加标签，分数等，以帮助您更好地管理规则。

**测试规则：**
- **基础测试：** 在特定数据集上测试一个规则。 这是一项快速测试，不会与其他规则结合，返回复杂结果。
- **对比测试：** 比较所选数据集或数据范围上的两个规则或两个规则集的检测结果。 测试将返回哪些实体（用户或事件）重叠（即匹配多个规则）或唯一地匹配一个或多个规则。
- **模拟测试：** 测试在现有的已发布规则集中添加和/或删除若干条规则的潜在影响。 默认情况下，所有已发布的规则都先进行模拟测试。此测试通常需要花费更多时间才能完成，但它会产生关于唯一和重合检测的更全面的结果。

**管理规则：**
- **规则分析：** 可以在“规则详细信息”页面（以下文档会介绍更多详细信息）中找到规则引擎的分析工具，在其中查看规则条件和规则随时间变化的表现。
- **编辑/删除规则：** 可以在“草稿”模式下编辑或删除规则。 有关更多详细信息，请参见下面的“编辑/删除规则”。
- **增加规则集：** 可以将多个规则放入一个规则集中，以实现更好的管理。

## 创建规则

### 定义条件

条件具有三个组成部分：“**特征**”，“**运算符**”，“**值**”，举例如下：

| 特征  |  运算符 | 值 |
| :--------: |:--------:|:-----:|
| email_verify | STARTS_WITH | john |

- **特征:** 可以来自原始字段，也可以由维择科技机器学习特征平台生成。多个特征一般用“AND/OR/NOT”逻辑连接。
- **运算符：** 特征如何被加工，参见第2.1.2“运算符”部分。
  - 请注意运算符取决于用户定义的数据类型。
- **值:** 指定的元素值。

#### 特征

您可以从下拉列表中选择一个特征，它既可以是原始数据字段，也可以是由维择科技特征功能平台衍生的特征。 如果您购买了维择科技特征计算平台，则可以在平台上创建一个新特征，并且在创建规则时使用。

您还可以“搜索特征”来查看所有可用特征，如下所示：

> 图 3: 搜索特征
![image-3]

这里会弹出窗口，显示每个特征的详细信息，包括 “类型”，“描述”，“创建者”和“可用（状态）”，如下图所示：

> 图 4: 特征详细信息
![image-4]

**数据类型：** 以下是维择科技规则引擎可以处理的数据类型。
- **布尔值：** “TRUE” or “FALSE”。
- **数值型：**
  - **整数：** 正或负或零的非小数（32位）。
    - **例如：**1或100
  - **双精度：** 一种数据类型，是指双精度浮点，64位浮点数据类型，可以表示小数和包括0的整数。
    - **例如：**1.32, 323.2, 120.00, 120
  - **长整数：** 长整数数据类型用于表示太大而无法表示为“整数”的数字（最多64位）包括0。
    - **例如：**9,223,372,036,854,775,807
- **字符型：**
  - **文本：** 表示文本而不是数字，由一组字符组成，这些字符也可以包含空格和数字。
  - **标准化：** 欺诈者经常尝试使用上标或下标来绕过可疑字符串的规则检测，例如 “Please text<sup>me</sup> directly to discuss<sub>special prices.</sub>”。维择科技可以把这些特殊字符串标准化为 “Please text me directly to discuss special prices,” 以便您的规则可以检测到此类行为。

#### 运算符

运算符会依照所选特征的数据类型去展示。类似于“搜索特征”，您也可以搜索“运算符”。

**注意：** 必须选定特征后才能搜索运算符或者选择运算符。

> Figure 5: 搜索运算符
![image-5]

以下是常见运算符的列表，并提供了有关如何使用每个运算符的示例：

- **STR_EQ**, **STR_EQ_NORMALIZED:** 检测字符串是否完全匹配。
  - **例如：**
    | 特征  | 运算符 | 值 |
    | :--------: |:--------:|:-----:|
    | user_id | STR_EQ | fraud.user@gmail.com |
  - **注：** 如果原始数据是 “fraud.user@<sub>gmail.com</sub>”, 您可可以使用运算符 “STR_EQ_NORMALIZED”  来检测该用户.。运算符将首先将特殊字符串转换为普通字符串(“fraud.user@gmail.com”)，然后检查规则中的匹配值。

    > 图 6: STR_EQ 运算符例
    ![image-6]

- **STR_NE**, **STR_NE_NORMALIZED:** 检测字符串是否不完全匹配。同样，与上面的示例类似，多了一个NOT条件。
  - **例如：**
    | 特征  |  运算符 | 值 |
    | :--------: |:--------:|:-----:|
    | email | STR_NE | fraud.user@gmail.com |
    | email | STR_NE_NORMALIZED | fraud.user@<sub>gmail.com</sub> |
  - **注：** “STR_NE_NORMALIZED”运算符将首先规范化字符串的下标或上标。
 - **STR_CONTAINS**, **STR_CONTAINS_NORMALIZED:** 检查是否存在指定的字符串序列。
   - **例如：**公司名字中是否包含关键字“维择”
     | 特征  | 运算符 | 值 |
       | :--------: |:--------:|:-----:|
       | company_name | STR_CONTAINS | 维择 |
   - **注：** “STR_CONTAINS_NORMALIZED”运算符将首先规范化字符串的下标或上标。
- **STR_STARTS_WITH**, **STR_STARTS_WITH_NORMALIZED:** 检查字符串是否以指定的元素序列开头。
  - **例如：**
    | 特征  | 运算符 | 值 |
    | :--------: |:--------:|:-----:|
    | user_id | STR_STARTS_WITH | fraud@ |
    | user_id | STR_STARTS_WITH_NORMALIZED | fraud |
  - **注：** “STR_STARTS_WITH_NORMALIZED”运算符将首先规范化字符串的下标或上标。
- **STR_ENDS_WITH**, **STR_ENDS_WITH_NORMALIZED:** 检查字符串是否以指定的元素序列结尾。
  - **例如：**
    | 特征  | 运算符 | 值 |
    | :--------: |:--------:|:-----:|
    | user_id | STR_ENDS_WITH | @gmail.com |
    | user_id | STR_ENDS_WITH_NORMALIZED | <sub>@gmail.com</sub> |
  - **注:** “STR_ENDS_WITH_NORMALIZED”运算符将首先规范化字符串的下标或上标。
- **STR_REGEX**, **STR_REGEX_NORMALIZED:** 正则表达式，是匹配字符串模式的方法。
  - 请参考以下部分以获取更多详细信息和示例。
- **STR_IN_LIST:** 检查指定的列表中是否包含某个字符串。
  - 输入值，请用“/n”（或按Enter）作为对象之间的分隔符。

    > 图 7: 输入列表
    ![image-7]

  - 添加到长列表中，可以在任何文本编辑器软件中输入列表，然后将其复制并粘贴（只要使用 “/n” 作为分隔符即可）。
  - 创建规则后，请验证“规则条件”中的列表为[value1，value2，…value(n)]。

    > 图 8: 规则条件
    ![image-8]

数值类特征常见的运算符按如下：

- **DOUBLE_EQ**, **INT_EQ**, **LONG_EQ：** 等于（==） 运算符（双精度，长整数，整数）。
- **DOUBLE_NE**, **INT_NE**, **LONG_NE:**
不等于（!=）运算符（双精度，长整数，整数）。
- **DOUBLE_GT**, **INT_GT**, **LONG_GT:** 大于（>）运算符（双精度，长整数，整数）。
- **DOUBLE_GE**, **INT_GE**, **LONG_GE:**
大于等于（>=）运算符（双精度，长整数，整数）。
- **DOUBLE_LT**, **INT_LT**, **LONG_LT:**
小于（<）运算符（双精度，长整数，整数）。
- **DOUBLE_LE**, **INT_LE**, **LONG_LE:**
小于等于（<=）运算符（双精度，长整数，整数）。

#### 值

选择特征和运算符后，将显示一个输入值框。

对于输入多个值或列表运算符时，可以通过上传文件的形式，比如黑白名单。 此功能仅当选择列表运算符时，才会出现。另外，我们推荐 *.txt*文件格式，每一行仅一个值。

**例如：**
值1
值2

**注意：** 你可以使用换行符或“/n”，在输入框中分开每个值。

> 图 9: 上传列表文件
![image-9]

#### 复制或删除条件

添加完一个条件后，您可以通过单击复制图标来快速的复制条件，如下所示。

> 图 10: 复制条件
![image-10]

您也可以在复制图标旁边，单击垃圾桶图标去删除条件。

**注意:** 条件一旦删除，便无法恢复。

#### 如何使用正则表达式 (REGEX)

更多详细信息和参考文献可以在有关“[如何使用REGEX](https://medium.com/factory-mind/regex-tutorial-a-simple-cheatsheet-by-examples-649dc1c3f285)"中去查询。

维择科技支持REGEX作为输入值。您可以按如下所述利用此功能。

| 已定义字符 | 定义 |
| :-------- |:--------|
| ^ | 匹配输入字符串的开始位置。 |
| $ | 匹配输入字符串的结束位置。 |
| . | 匹配除“\n”之外的任何单个字符。 |
| \| |匹配x或y。**例如：**“z\|food”能匹配“z”或“food”。“(z\|f)ood”则匹配“zood”或“food”。|
| {...} | 匹配明确的量词符号，**例如：**“o{2}”不能匹配"Bob"中的“o”，但是能匹配 "food"中的两个“o”。 |
| [...] | 明确匹配的字符集。匹配所包含的任意一个字符。**例如：**“[abc]”可以匹配 “plain”中的“a”。 |
| (...) | 匹配pattern并获取这一匹配。所获取的匹配可以从产生的matches 集合得到。**例如：**“Windows（?=95\|98\|NT\|2000）”能匹配“Windows 2000”中的 “Windows” ，但不能匹配“Windows 3.1”中的“Windows”。**例如：**“Windows (?!95\|98\|NT\|2000)”能匹配“Windows 3.1”中的“Windows”，但不能匹配“Windows 2000”中的“Windows”。|
| * | 匹配前面的子表达式零次或多次。**例如：**“zo*”能匹配“z”以及“zoo”。“*”等价于{0,}。|
| + | 匹配前面的子表达式零次或一次。**例如：**“do(es)?”可以匹配“do”或“does”中的 “do?”。“+”等价于{0,1}。|
| ? | 当该字符紧跟在任何一个其他限制符（*, +, ?, {n}, {n,}, {n,m}） 后面时，匹配模式是非贪婪的。非贪婪模式尽可能少的匹配所搜索的字符串，而默认的贪婪模式则尽可能多的匹配所搜索的字符串。**例如：** 对于字符串“oooo”，“o+?” 将匹配单个“o”，而“o+”将匹配所有“o”。|
| \ | 将下一个字符标记为一个特殊字符，或一个原义字符，或一个向后引用，或一个八进制转义符。**例如：**“n”匹配字符“n”。“\n”匹配一个换行符。序列“\\”匹配“\”而 “\(”则匹配“(”。|

| 字符类 | 定义 |
| :---------------- | :------ |
| . | 匹配“\n”以外的任何字符。如果通过“单行”选项修改，则句点字符将与任何字符匹配。有关更多信息，请参见[正则表达式](https://regexone.com/)部分。|
| [aeiou] | 匹配指定字符串中包含的任何单个字符。|
| \^[aeiou] | 匹配不在指定字符串中的任何单个字符。|
| [0-9a-fA-F] | 使用连字符（“–”）可以指定连续的字符范围。 |
| \p{name} | 匹配{name}指定的命名字符类中的任何字符。 支持的名称是统一码组和块范围。 **例如：** Ll，Nd，Z，IsGreek，IsBoxDrawing。|
| \P{name} | 匹配未包含在{name}中指定的字符块。 |
| \w | 匹配任何单词字符.等效于统一码字符类别[\p{Ll}\p{Lu}\p{Lt}\p{Lo}\p{Nd}\p{Pc}]。如果使用ECMAScript选项指定了ECMAScript兼容行为，则“\w”等效于 [a-zA-Z_0-9]。|
| \W | 匹配任何非单词字符。等效于统一码类[^\p{Ll}\p{Lu}\p{Lt}\p{Lo}\p{Nd}\p{Pc}]。如果使用ECMAScript选项指定了ECMAScript兼容行为，则“\w”等效于[^a-zA-Z_0-9]。|
| \s | 匹配任何空格字符。等效于统一码字符类别[\f\n\r\t\v\x85\p{Z}]。如果使用ECMAScript选项指定了ECMAScript兼容行为，则“\s”等效于[\f\n\r\t\v]。|
| \S | 匹配任何非空格字符。等效于统一码字符类别[^\f\n\r\t\v\x85\p{Z}]。如果使用ECMAScript选项指定了ECMAScript兼容行为，则“\S”等效于[^\f\n\r\t\v]。|
| \d | 匹配任何十进制数字。等效于“\p{Nd}”（对于统一码）和[0-9]（对于非统一码)，ECMAScript行为。|
| \D | 匹配任何非数字。等效于“\P{Nd}”（对于统一码）和[^0-9]（对于非统一码），ECMAScript行为。|

### 定义触发规则后的动作

#### 维择科技动作

默认情况下，动作之间的连接逻辑为“AND”，这意味着如果选择两个动作，则在满足条件（IF）的情况下将同时执行两个动作。维择科技规则动作是系统默认设置，无法删除。

有关规则的动作如何与您内部系统集成的更多信息，请参阅2.2.2“动作与相应”。

规则触发后的动作包括但不限于：

| 动作 | 定义 |
| :---------------- | :------ |
| **接受** | 允许执行该事件或用户，具体由您设定。 |
| **拒绝** | 阻止动作或者相应的行为。 |
| **打标** | 用自定义的标签来打标。 选择此标签后，您将能够在标签数据框中输入标签内容或者选择已有的标签。 |
| **审核** | 将规则结果发送给运营团队做进一步调查。 |
| **打分** | 允许规则的分数集成到后端的响应中。**例如：** 根据规则检测到用户，并且“规则分数”为0.85，我们可以在响应中包括“得分：0.85”。|
| **白名单** |  标记为“好”，针对用户或事件。 |
| **黑名单** | 标记为“坏”，针对用户或事件。 |
| **规则集** | 如果满足此规则的条件，我们将运行选定的规则集。**例如：** 1. 在规则A中，我们将操作设置为“运行规则集”并选择“规则集B”。2. 当用户X满足规则A中设置的条件时，它还将运行“规则集B”以检查用户X。|
| **设定阈值** | 在下拉菜单中，我们显示所有可用功能。**例如：** 1. 您想要创建一个规则，如果满足条件，则得分加10。 如果分数达到某个阈值，则可以创建另一个规则来做出决定。**规则1：** 如果值> 10,000美元，则可以设置得分加10。**规则2:** 得分> 90，则进行人工核实。2.  然后，根据所选的特征，您可以选择以下两个运算符：加或减。3. 最后，您输入一个值，维择科技还将检查输入值的数据类型是否与功能的数据类型匹配。例如，对于“风险分数“，值必须为数字。|

**计数功能：**

计数功能为运营团队提供了一种快速的方法来设置规则，在指定次数的规则被触发时，检测规则和用户行为的有效性。

> 图 11: 计数功能
![image-11]

**示例1：**
您想拒绝策略中的“电话号码出现3次”的用户。

**规则1：** 如果“product_desc”包含“电话号码”，请计算触发此规则的次数。您可以将此计数器命名为“count_phone”。

**规则2：** 如果“count_phone” > 3，则将操作设置为拒绝。

对于此示例，选中“计算每个用户触发此规则的次数”框。输入此计数器的名称； 然后，您就可以在“条件（IF）”中选择此功能，输入说明以提醒其他人计数器的功能。

***示例2：***
**创建规则：** "user_ip_country" 不等于 "Germany"。
**计数：** 每个用户在德国境外的IP计数。

#### 动作与响应

当规则引擎中的规则检测到事件或用户时，维择科技会以预先定义的格式将响应动作发送到下游系统的后端。在响应中，我们包含您在创建规则时指定的动作和动作数据。

**例如：**
创建一条规则来检测任何大于5,000美元的交易，为此用户的动作设置为打标，并将“动作标签”设置为“大额交易”。响应可能如下所示：

> 图 12: 动作与响应
![image-12]

维择科技将动作和动作标签返回给您，您有权做最终的处置响应。

### 创建规则集

您可以在主页的右上角找到规则集。您可以选择一个或多个规则去创建一个新的规则集。

> 图 13:  创建规则集
![image-13]

为了您的方便，我们在规则选择表中提供了过滤器。例如，您可以过滤，仅查看“手动规则”或“自动规则”去选择您想要的规则。

在“创建规则”页面中，您可以通过单击“测试规则”来快速测试您的规则。该规则将自动以“草稿”模式保存，并且您可以直接到“测试中心”以选择要测试的规则。 更多详细信息，请参阅第3.1节“规则基本测试”。

## 测试规则

我们的测试功能围绕“测试中心”构建，测试中心可以通过规则引擎的“主页”进行访问。在测试中心，您可以执行不同类型的测试：“**基本测试**”，“**对比测试**”或“**模拟测试**”。

### 测试中心

#### 使用案例

测试中心可用于不同目的：
- **基本测试：** 用于测试单个规则或者规则集。这一测试确保新创建的规则可以检测到您打算监测的可疑事件或用户，或者验证现有规则是否能达到预期的效果。
- **比较测试：** 用于比较两条规则或者两个规则集的检测效果，决定是否下线其中的一条或者一组规则。
- **模拟测试：** A用于测试如果在生产环境中增加新的规则，是否增加了检测到用户/事件的数量。例如，如果您有200条在生产上运行的规则，基于新出现的欺诈模式，你创建了三条新的规则。通过比较测试，可以比较203条规则的监测能力是否优于之前的200条规则。

#### 进入测试中心

测试中心位于主页的右上角位置，同时您也可以创建规则时进入测试中心；当点击创建规则下的测试规则时，规则将以“草稿”的模式被暂时创建，同时进入下面的窗口。

> 图 14: 进入测试中心
![image-14]

为方便起见，在新的任务运行之前，最近一次的任务结果将被保留。

### 基本测试

如下图所示，在测试中心中点击基本测试进入调试。

> 图 15: 基本测试
![image-15]

#### 测试一个规则或规则集

除了单条规则测试之外，我们还提供测试一个规则集的功能。如下图红框所示，通过切换规则或规则集，匹配测试对象类型，以满足测试需要。

> 图 16: 选一个规则或规则集
![image-16]

如果规则集被选中，测试将返回规则集中所有规则测试结果。另外还会提供一个表格，汇总各个规则的所有检测结果。

#### 选择时间窗口

时间窗口有多种选择方式：“**自定义时间**”，“**过去1天**”，“**过去3天**”，“**过去5天**”，“**以及过去七天**”。“过去x天”选项是以小时计算的。也就是说，过去7天意味着从我们最后一次接收到您的后台数据前的168个小时开始接入测试。

**注意：** “过去X天”选项是动态移动时间范围选择，这意味着它们是根据系统发送到维择科技的最新时间点的数据计算得出的。

**示例：**
如果最新事件时间节点为“April 28, 13:50”，并且选择“过去1天”，维择科技将用从 “04/27/2020 13:50” 到 “04/28/2020 13:50”期间的数据接入测试。

#### 手工输入测试

我们提供高级功能以便您检查规则或规则集的语法是否正确（条件逻辑）。在这一测试中，您可以手动提供JSON格式的一行数据（例如，用户或事件），以便针对选定的规则或规则集进行测试。

> 图 17: 手工输入测试
![image-17]

- 我们将JSON格式的输入视为“属性值”对。规则引擎将检查所选规则的逻辑。
- 如果一个属性在规则条件中被提到，但在手动输入中不存在，我们将把它视为不满足该条件。

#### 基本测试结果表

检测结果表的例子如下图所示。

> 图 18: 基本测试结果表
![image-18]

“**检测属性**”是在规则条件中触发的特征或属性. 例如，如果示例规则A具有条件（如果交易金额>$4000或设备代理=“android 4.0”），则此处的检测属性为“交易金额”和“设备代理”。

检测属性的触发值将高亮显示。在上述例子中，$4,000 将会高亮显示，因为其为规则A中“交易金额”这一属性的触发值。

在“结果表”中，我们也提供了如“导入”，“搜索”，“排序”等功能。

#### 利用用户ID或事件ID进行测试

此测试允许您基于特定用户或特定事件检查规则或规则集是否正确。您可以选择在用户级别还是事件级别进行测试。

为对多个用户或者多个事件同时测试，您可以使用逗号（“,”）作为分隔符。

> 图 19: 测试多个用户 (或事件)
![image-19]

结果表将以相同的方式显示，被检测的用户数（或者事件数）将显示在上方，同时也会显示依据规则与规则集检测出的用户（或者事件）。

### 对比测试

此功能用于评估两组规则/规则集值之间检测量的差异。您可以选择历史数据范围。为方便起见，我们提供了三个默认选项："**过去1天**"，"**过去3天**"以及"**过去7天**"。

#### 选择规则或规则集

与"基本测试"相同，您可以通过切换规则和规则集合组页面选择测试对象，与您的测试需求匹配。如下图所示。

> 图 20: 对比测试
![image-20]

#### 对比测试结果表

下图为对比测试的检测结果表示例。

> 图 21: 对比测试结果表
![image-21]

规则A的净影响为有且只有通过规则A触发的唯一检测量，类似地，规则B的净影响为有且只有通过规则B触发的唯一检测数量。

元分析概述了规则A与规则B的检测结果，包括“**总检测**”情况，“**规则唯一检测**”情况与“**重叠检测**”情况。对于检测结果类型定义，请参考4.1.1“规则元数据”。

在结果表中，我们将显示所有检测结果。您可以查看任意一个规则（A/B）的检测结果，也可以查看所有规则（A&B）的检测结果。

### 模拟测试

您可以在“测试中心”页面选择“模拟测试”。

> 图 22: 模拟测试
![image-22]

#### 为模拟测试选择规则

默认情况下，我们在测试时包含了所有已发布的规则。但是您可以选择想要移除的已发布规则，并且添加模式为“测试” 或 “草稿” 的规则进行“模拟测试”。

如下图所示，为“模拟测试”选择规则时，选定的规则将高亮标出，当前选定的规则数量将实时更新并显示。

> 图 23: 为模拟测试选择规则
![image-23]

#### 模拟测试结果表

下图为模拟测试结果表范例。

> Figure 24: Simulation Result Table
![image-24]

模拟测试的规则的净影响计算公式为：“唯一由模拟测试规则检测的数量”-“唯一由已发布规则检测的数量”。因此，如果模拟测试规则的唯一检测数量更低，则其净影响可能为负值。

结果表概述了在相同的时间窗口中当前规则以及模拟规则的检测结果（“总检测数”，“唯一检测数”，“重叠检测数”）。通过比较当前生产规则与模拟规则检测结果差异，可以用来评估模拟规则的实际影响。

## 管理规则

### 规则分析

维择科技为每个规则提供分析数据，在“**规则详情**”界面展示。

在主页的规则表中，点击任意规则名称（以超链接形式显示）进入规则详情界面，查看规则详情。

> 图 25: 进入规则详情界面
![image-25]

如下图所示，进入指定规则的规则详情界面。

> 图 26: 规则详情界面
![image-26]

#### 规则元数据

**示例：**

**规则1：** 检测用户{A, B, C, D, E}

**规则2：** 检测用户{A, E}

对于规则1来说，“唯一检测”结果为3，因为{B, C, D}只被规则1检测到，规则2 没有。另外规则2的“唯一检测”结果为0，因为规则2检测到的{A,E}也都被规则1检测到。

对于规则1与规则2来说，“重叠检测”结果为2，因为{A,E}同时被规则1与规则2检测到，数量为2。

规则1的“总检测量”为5，因为规则1检测到了{A,B,C,D,E}，共5个用户。规则2的“总检测量”为2，因为规则2检测到了{A,E}，共2个用户。

除了三种不同的检测方式，您也可以在“规则详情”界面查看更多信息，如：
- 规则ID，规则分数，创建者，创建日期
- 更近一次更新时间，最近一次更新人
- 如果您启用了队列管理功能（另外一个产品模块提供），还将显示与该规则关联的审核队列。

#### 规则条件

默认状态下，“效果表”将显示最近7天检测信息。但是您可以通过选择不同的时间范围调整显示结果。当您选择新的时间范围时，“效果表”与“结果表”的结果将一起更新。

#### 重叠分析

“**重叠分析**”以可视化形式，显示与选定规则的检测结果重叠最多的规则。在重叠图中，维择科技只显示与当前规则的检测结果重叠最多的前两条规则。

重叠分析图中显示数据有两种时间范围选择：最新时间（今天）或过去7天。

**注意：** 由于选择时间范围不同，与当前选定规则检测结果重复最多的前两条规则可能不同。

在重叠分析表下的结果表依据选定时间范围而动态呈现。因为最新时间（今天）与过去七天的数据集不同，其相应检测结果不同。

### 切换用户或事件

如果您拥有在用户级别以及事件级别检测的混合规则集，您可以选择依据用户还是依据事件。在规则详情页的结果表以及测试中心的结果表将根据您的选择而呈现不同的结果。如果您选择用户级别，则呈现检测到的用户；选择事件级别，将显示检测到的事件。

> 图 27: 切换用户或事件
![image-27]

**示例：**
如果您切换到“事件”级别，点击一条规则进入规则详情界面，在规则表现上的每个检测行都会对应一个事件ID开头的事件。

[image-1]: static/docs/images/zh/1_RuleSet.png
[image-2]: static/docs/images/zh/2_Workflow.png
[image-3]: static/docs/images/zh/3_SelectFeature.png
[image-4]: static/docs/images/zh/4_FeatureDetails.png
[image-5]: static/docs/images/zh/5_SelectOperator.png
[image-6]: static/docs/images/zh/6_OperatorSTR_EQ.png
[image-7]: static/docs/images/zh/7_STR_IN_LIST.png
[image-8]: static/docs/images/zh/8_RuleCondition.png
[image-9]: static/docs/images/zh/9_UploadFile.png
[image-10]: static/docs/images/zh/10_CopyCondition.png
[image-11]: static/docs/images/zh/11_CountFunctionality.png
[image-12]: static/docs/images/zh/12_ActionResponse.png
[image-13]: static/docs/images/zh/13_CreateRuleSet.png
[image-14]: static/docs/images/zh/14_AccessTestCenter.png
[image-15]: static/docs/images/zh/15_BasicTest.png
[image-16]: static/docs/images/zh/16_ToggleRuleRuleSet.png
[image-17]: static/docs/images/zh/17_ManualInput.png
[image-18]: static/docs/images/zh/18_BasicTestResults.png
[image-19]: static/docs/images/zh/19_TestUserID.png
[image-20]: static/docs/images/zh/20_Comparison.png
[image-21]: static/docs/images/zh/21_ComparisonTestResults.png
[image-22]: static/docs/images/zh/22_Simulation.png
[image-23]: static/docs/images/zh/23_SimulationSelectRules.png
[image-24]: static/docs/images/zh/24_SimulationTestResults.png
[image-25]: static/docs/images/zh/25_AccessRuleDetails.png
[image-26]: static/docs/images/zh/26_RuleDetails.png
[image-27]: static/docs/images/zh/27_ToggleEventUser.png
